<div>
    <div *ngIf="title" class="div-title">
        <span translate={{title}}></span>
        <div *ngIf="sigle && description" class="d-flex subtitle">
            <span translate={{sigle}}></span> <span>-</span><span translate={{description}}></span>
        </div>
        <p-divider></p-divider>
    </div>
    <form *ngIf="control" [formGroup]="control" class="row row-custom">
        <div *ngFor="let campo of form" class="{{campo.col}} col-sm-12">
            <label class="form-label" *ngIf="campo.label">{{campo.label}}
            </label>
            <label class="form-label ml-2" *ngIf="campo.secondLabel">{{campo.secondLabel}}
            </label>
            <label *ngIf="campo.required" class="danger-text ml-2">*</label>
            <div class="mb-3 ">

                <!-- text -->
                <input [ngClass]="{
                    'ng-invalid ng-dirty':
                    validateForm && control.controls[campo.formControl].errors
                  }" pInputText *ngIf="campo.type == 'text' || campo.type == 'number' " (change)="onChangevalues()"
                    type={{campo.type}} class="form-control" formControlName={{campo.formControl}} />

                <!-- select -->
                <p-dropdown [ngClass]="{
                    'ng-invalid ng-dirty':
                    validateForm && control.controls[campo.formControl].errors
                  }" styleClass="w-100 form-control p-0" (onChange)="onChangevalues()" placeholder="Selecione"
                    *ngIf="campo.type === 'select'" [options]="campo.options" formControlName={{campo.formControl}}
                    [disabled]="campo.disabled" optionLabel="descricao"></p-dropdown>

                <!-- treeSelect -->
                <p-treeSelect [ngClass]="{
                    'ng-invalid ng-dirty':
                    validateForm && control.controls[campo.formControl].errors
                  }" (onNodeSelect)="onChangevalues()" *ngIf="campo.type === 'tree-select'"
                    containerStyleClass="w-100 form-control p-0" formControlName={{campo.formControl}}
                    [options]="campo.treeSelectOptions" [filter]="true" [filterInputAutoFocus]="true"
                    [disabled]="campo.disabled" emptyMessage="Nenhum dado encontrado" [showClear]="true"
                    (onClear)="campo.clean()"></p-treeSelect>

                <!-- autoComplete -->
                <p-autoComplete [ngClass]="{
                    'ng-invalid ng-dirty':
                    validateForm && control.controls[campo.formControl].errors
                  }" styleClass="w-100 form-control p-0" [inputStyle]="{'width':'100%'}" (onSelect)=" onChangevalues()"
                    [disabled]="campo.disabled" *ngIf="campo.type === 'autocomplete'"
                    formControlName={{campo.formControl}} [suggestions]="filteredAutoComplete"
                    (completeMethod)="filterAutoComplete($event, campo.options)" [forceSelection]="false"
                    dropdownMode="current" dataKey="id" field="descricao"></p-autoComplete>

                <!-- date -->
                <div class="d-flex-custom" *ngIf="campo.type === 'date' && campo.datePeriod">
                    <p-calendar [selectOtherMonths]="true" [minDate]="minDateAll" styleClass="w-100 form-control p-0"
                        (onSelect)="onChangevalues()" dateFormat="dd/mm/yy" [disabled]="campo.disabled"
                        placeholder="dd/mm/aaaa" [showIcon]="true" formControlName={{campo.formControl}}
                        (onBlur)="onBlurDate($event)"></p-calendar>
                    <span class="calendarPeriod">{{translate.instant('globals.between_dates')}}</span>
                    <p-calendar [selectOtherMonths]="true" styleClass="w-100 form-control p-0"
                        (onFocus)="onFocusDate(control.value['períodoIni'])" (onSelect)="onChangevalues()"
                        [minDate]="minDate" [maxDate]="maxDate" dateFormat="dd/mm/yy" [disabled]="campo.disabled"
                        placeholder="dd/mm/aaaa" [showIcon]="true" formControlName={{campo.formControlSecondary}}
                        (onBlur)="onBlurDate($event)"></p-calendar>
                </div>
                <div *ngIf="campo.type === 'date' && !campo.datePeriod">
                    <p-calendar (onSelect)="onChangevalues()" [selectOtherMonths]="true" [minDate]="minDateAll"
                        styleClass="w-100 form-control p-0" dateFormat="dd/mm/yy" [disabled]="campo.disabled"
                        placeholder="dd/mm/aaaa" formControlName={{campo.formControl}} [showIcon]="true"
                        (onBlur)="onBlurDate($event)"></p-calendar>
                </div>

                <!-- date-time -->
                <div *ngIf="campo.type === 'date-time'">
                    <p-calendar [ngClass]="{
                        'ng-invalid ng-dirty':
                        validateForm && control.controls[campo.formControl].errors
                      }" (onSelect)="onChangevalues()" [selectOtherMonths]="true"
                        [(minDate)]="campo.minDate ?? minDateAll" [(maxDate)]="campo.maxDate"
                        styleClass="w-100 form-control p-0" dateFormat="dd/mm/yy" [disabled]="campo.disabled"
                        placeholder="dd/mm/aaaa hh:mm" formControlName={{campo.formControl}} [showIcon]="true"
                        [showTime]="true" (onBlur)="onBlurDate($event)"></p-calendar>
                </div>

                <!-- textarea -->
                <textarea [ngClass]="{
                    'ng-invalid ng-dirty':
                    validateForm && control.controls[campo.formControl].errors
                  }" pInputTextarea (attr.change)="onChangevalues()" [attr.disabled]="campo.disabled"
                    *ngIf="campo.type === 'text-area' " pInputTextarea formControlName={{campo.formControl}}
                    class="form-control" rows={{campo.rows}}></textarea>

                <!-- checkbox -->
                <div *ngIf="campo.type == 'check-box'">
                    <input (change)="onChangevalues()" [attr.disabled]="campo.disabled" id="checkbox" type='checkbox'
                        formControlName={{campo.formControl}} class="mr-10">
                    <label class="form-label" translate={{campo.label}}></label>
                </div>

                <!-- button -->
                <button pButton *ngIf="campo.type == 'button'" class='{{campo.class}} w-100 mt-3'
                    (click)="campo.onCLick()" icon={{campo.icon}} [label]="translate.instant(campo.label)"
                    [disabled]="campo.disabled"></button>

                <!-- upload files -->
                <div *ngIf="campo.type === 'upload-files' && !campo.disabled " ngx-dropzone class="drag-image"
                    [accept]="campo.acceptFiles" (change)="onSelect(campo.formControl, $event)">
                    <ngx-dropzone-label>
                        <div><i class="pi pi-cloud-upload"></i></div>
                        <h6>Clique ou arraste e solte um arquivo para anexar</h6>
                        <span>{{campo.msgAcceptFiles}}</span>
                    </ngx-dropzone-label>
                    <div *ngFor="let f of filesDonwload">
                        <ngx-dropzone-image-preview *ngIf="f.type && f.type.includes('image')" [file]="f"
                            [removable]="true" (removed)="onRemove(f)">
                            <ngx-dropzone-label>{{ f.name }}</ngx-dropzone-label>
                        </ngx-dropzone-image-preview>
                        <ngx-dropzone-preview *ngIf="f.type && !f.type.includes('image')" [file]="f" [removable]="true"
                            (removed)="onRemove(f)">
                            <ngx-dropzone-label>{{ f.name }}</ngx-dropzone-label>
                        </ngx-dropzone-preview>
                        <ngx-dropzone-preview *ngIf=" f.id" [file]="f" [removable]="true" (removed)="onRemove(f)">
                            <ngx-dropzone-label>{{ f.name }}</ngx-dropzone-label>
                        </ngx-dropzone-preview>
                    </div>
                </div>

                <!-- upload files disabled -->
                <div *ngIf="campo.type === 'upload-files' && campo.disabled ">
                    <p-button (click)="op.toggle($event)" icon="pi pi-paperclip"
                        [label]="translate.instant('globals.files')"></p-button>

                    <p-overlayPanel #op [style]="{'width': '450px'}" [showCloseIcon]="true">
                        <ng-template pTemplate="content">
                            <p-table *ngIf="files.length > 0" [value]="files" selectionMode="single"
                                [(selection)]="selectedProduct" (onRowSelect)="onRowSelect($event, op)"
                                responsiveLayout="scroll">
                                <ng-template pTemplate="header">
                                    <tr>
                                        <th pSortableColumn="name">{{translate.instant('globals.name')}}<p-sortIcon
                                                field="name"></p-sortIcon></th>
                                    </tr>
                                </ng-template>
                                <ng-template pTemplate="body" let-rowData let-file>
                                    <tr [pSelectableRow]="rowData">
                                        <td>{{file.name}}</td>
                                        <td> <p-button icon="pi pi-download"
                                                (click)='dowloadFIle($event,file)'></p-button>
                                        </td>
                                    </tr>
                                </ng-template>
                            </p-table>
                            <div *ngIf="files.length === 0" class="p-10">
                                <label>{{translate.instant('globals.notFiles')}}</label>
                            </div>
                        </ng-template>
                    </p-overlayPanel>
                </div>

                <!-- list -->
                <ul *ngIf="campo.type === 'list' && campo.options">
                    <li *ngFor="let list of campo.options">{{list.descricao}}</li>
                </ul>

                <!-- multi -->
                <p-multiSelect *ngIf="campo.type === 'multi'" [options]="campo.options"
                    formControlName={{campo.formControl}} styleClass="form-control p-0"
                    optionLabel="descricao"></p-multiSelect>

                <!-- radioButton -->
                <div *ngIf="campo.type === 'radio-button'" class="d-flex">
                    <div *ngFor="let listRadioButton of campo.options" class="field-checkbox">
                        <p-radioButton [disabled]="campo.disabled" [value]="listRadioButton.id"
                            formControlName={{campo.formControl}} class="mr-10"></p-radioButton>
                        <label class="mr-1">{{listRadioButton.descricao}}</label>
                    </div>
                </div>

                <!-- selectButton -->
                <div class="d-flex" *ngIf="campo.type === 'select-button'">
                    <p-selectButton (onChange)="onChangevalues()" [disabled]="campo.disabled" [options]="campo.options"
                        formControlName={{campo.formControl}} optionValue="id">
                        <ng-template let-item>
                            <span>{{item.descricao}}</span>
                        </ng-template>
                    </p-selectButton>
                    <!-- <input type="text" pInputText class="form-control" [attr.disabled]="campo.disabled"
                        formControlName={{campo.formControlSecondary}}> -->
                </div>

                <!-- table -->
                <p-table *ngIf="campo.type === 'table'" [columns]=campo.colsTable styleClass=p-datatable-striped
                    [value]=campo.rowsTable>
                    <ng-template pTemplate="header" let-columns>
                        <tr>
                            <th *ngFor="let col of columns">
                                {{ col.header }}
                            </th>
                        </tr>
                    </ng-template>
                    <ng-template pTemplate="body" let-rowData let-columns="columns">
                        <tr>
                            <td *ngFor="let col of columns">
                                <div *ngIf="col.field !== 'button'">
                                    {{ rowData[col.field] }}
                                </div>
                                <div *ngIf="col.field == 'button'">
                                    <p-button styleClass={{rowData[col.field].styleClass}}
                                        label={{rowData[col.field].label}} (click)="rowData[col.field].onCLick(rowData)"
                                        icon={{rowData[col.field].icon}}></p-button>
                                </div>
                            </td>
                        </tr>
                    </ng-template>
                </p-table>

                <!-- inputSwitch -->
                <div class="d-flex" *ngIf="campo.type === 'switch'">
                    <p-inputSwitch [disabled]="campo.disabled" formControlName={{campo.formControl}} class="mr-10"
                        (onChange)="onChangevalues()"></p-inputSwitch>
                    <p translate={{campo.label}}></p>
                </div>

                <!-- password -->
                <p-password [ngClass]="{
                    'ng-invalid ng-dirty':
                    validateForm && control.controls[campo.formControl].errors
                  }" *ngIf="campo.type === 'password'" [feedback]="false" formControlName={{campo.formControl}}
                    (onChange)="onChangevalues()" styleClass="w-100" inputStyleClass="form-control"
                    [toggleMask]="true"></p-password>

                <!-- validação de campo obrigatório -->
                <div class="h-10">
                    <small class="danger-text"
                        *ngIf="validateForm && control.controls[campo.formControl] && control.controls[campo.formControl].errors">
                        Campo obrigatório
                    </small>
                </div>
            </div>
        </div>

        <p-divider
            *ngIf="(buttonsStandard && buttonsStandard.length > 0) || (buttonsOptional && buttonsOptional.length > 0)"></p-divider>

        <div class="buttons-form">
            <div *ngFor="let button of buttonsStandard">
                <p-button *ngIf="button.type === 'clean'" styleClass="p-button-warning {{button.styleClass}}"
                    label="Limpar" (click)="button.onCLick()" icon="pi pi-times"></p-button>
                <p-button *ngIf="button.type === 'filter'" styleClass="{{button.styleClass}}" label="Filtrar"
                    (click)="button.onCLick()" icon="pi pi-search"></p-button>
                <p-button *ngIf="button.type === 'save'" styleClass="p-button-success {{button.styleClass}}"
                    label="Salvar" (click)="button.onCLick()" icon="pi pi-save"></p-button>
                <p-button *ngIf="button.type === 'cancel'" styleClass="p-button-danger {{button.styleClass}}"
                    label="Cancelar" (click)="button.onCLick()" icon="pi pi-times"></p-button>
            </div>
            <div *ngFor="let button of buttonsOptional">
                <p-button styleClass={{button.styleClass}} label={{button.label}} (click)=" button.onCLick()"
                    icon={{button.icon}}></p-button>
            </div>
        </div>
    </form>
</div>